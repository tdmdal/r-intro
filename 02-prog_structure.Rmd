# Programming structure

```{r, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```


## Three basic control flows

### Sequence

Code runs line by line in sequence with no conditional executions or loops. For example, let's write some code to calculate the following sum of squares.

$$y = \sum_{t=1}^{3} t^2.$$

```{r}
# sum of squares
t <- 1:3
y <- sum(t^2)
print(y)
```

### Conditional execution

```
# if, else
if (condition) {
  # code executed when condition is TRUE
} else {
  # code executed when condition is FALSE
}
```

```
# if, else if, else
if (condition1) {
  # do something when condition1 is TRUE
} else if (conditon2) {
  # do something else if condition1 is FALSE but condition2 is TRUE
} else {
  # do something if neither condition1 nor condition2 is TRUE
}
```

For example, if the above sum of squares `y > 10` then print out "result greater than 10", or otherwise print out "result less or equal to 10".

```{r}
if (y > 10) {
  print("result greater than 10")
} else {
  print("result less or equal to 10")
}
```

### Iteration

```
# for loop
for (var in seq) {
  do something
}
```

```
# while loop
while (condition) {
  do something if condition is TRUE
}
```

For example, let's solve the above sum of squares using a loop.
```{r}
t <- 1:3
y <- 0

for (x in t) {
  y <- y + x^2
}

print(y)
```

**Exercise**

Calculate the above sum using a while loop.

```{r}
# your code here
```


## Functions

A function is a unit of code block that (usually) takes in some inputs (arguments) and returns a result. We have already used many R functions, for example, `print()` and `length()`.

The two main reasons to write functions are *reusability* and *abstraction*. If you find yourself repeating the same code logic or if you want to divide a large piece of code into small logical units, you should consider writing functions.

In fact, "everything that happens [in R] is a function call." (John Chambers, the creator of the S programming language and a core member of the R project. R is modelled after S.) For example, even the plus operation "`+`" is a function: try typing `` `+`(1, 2) `` in the R console and see what you get.

Let's write a slightly general version of sum of squares using a function.

$$y = \sum_{t=1}^{n} t^2.$$

This function takes in 1 argument `n`, and return the sum `y` defined above.

```{r}
ss <- function(n) {
  t <- 1:n
  
  # the last expression is automatically returned
  # or otherwise, you could write return(sum(t^2))
  sum(t^2)
}

print(ss(2))
print(ss(3))
```

**Exercise**

Write an R function to calculate $$y = \sum_{t=1}^{n} f(t),$$ where $n$ is an integer and $f()$ is a generic function that you can define later (e.g. $f(t) = t ^ 2$ or $f(t) = t ^ 3$). The R function takes in two argument, `n` and `f` as in the above formula, and returns the sum $y$.

```{r, eval=FALSE}
# your code here
f_sum <- function(f, n) {

  # insert your code below
  
  return(y)
}

# if your code works as intended, the following should run

# define t squared as f1
f1 <- function(t) {
  t^2
}

print(f_sum(f1, 3L))

# let's calculate pi
# calculate pi using the pi formula
f_pi <- function(x) {
  4 * (-1) ^ (x + 1) / (2 * x - 1)
}
```


